(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[110],{"WB+k":function(e,a,t){"use strict";t.r(a);t("IzEo");var n,l,i,s=t("bx4M"),r=(t("+L6B"),t("2/Rp")),o=t("MVZn"),m=t.n(o),c=(t("OaEy"),t("2fM7")),u=(t("giR+"),t("fyUT")),p=(t("/zsF"),t("PArb")),d=(t("14J3"),t("BMrR")),h=(t("5NDa"),t("5rEg")),g=(t("jCWc"),t("kPKH")),E=(t("BoS7"),t("Sdc0")),f=t("lwsE"),y=t.n(f),D=t("W8MJ"),b=t.n(D),C=t("a1gu"),v=t.n(C),R=t("Nsbk"),T=t.n(R),F=t("7W2i"),O=t.n(F),k=(t("y8nQ"),t("Vl3Y")),G=(t("sRBo"),t("kaz8")),I=(t("iQDF"),t("+eQT")),w=t("q1tI"),V=t.n(w),S=t("MuoO"),x=(t("+n12"),t("SwfG")),P=t("rR2S"),B=t("fKoC"),L=t.n(B),q=t("28NX"),M=t.n(q),A=t("wd/R"),j=t.n(A),N=(I["a"].MonthPicker,I["a"].RangePicker,I["a"].WeekPicker,G["a"].Group),Y={labelCol:{span:5},wrapperCol:{span:19}},z=(k["a"].Item,[{label:"\u79fb\u52a8\u53f7\u7801",value:"1000"}]),H=(n=Object(S["connect"])(function(e){var a=e.resource;e.loading;return{data:a,ruleForm:a.ruleForm}}),l=k["a"].create(),n(i=l(i=function(e){function a(e){var t;return y()(this,a),t=v()(this,T()(a).call(this,e)),t.state={isChannelGreatDisabled:!1,isChannelGreatDefaultChecked:!1,isChannelOpeningSwitch:!1,isChannelOpeningDefaultChecked:!1,channelGreatObjTypeDefaultValue:[],isShowChannelGreatForm:!1,isUsageTypeDisabled:!0,isTimeLimitTypeDisabled:!0,isShowAppointForm:!1,isAppointmentTypeDisabled:!0,isBalanceOpportunityDisabled:!0,isVerificationTypeDisabled:!0,isBalancePriceDisabled:!1,timeDurationLimit:30,usageType:[]},t}return O()(a,e),b()(a,[{key:"componentDidMount",value:function(){this.props.data;var e=this.props.data,a=(e.paramsArr,e.index,e.selectedTemplate),t=(e.currentStep,a);"-1"!=t.isChannelGreat&&(this.setState({isShowChannelGreatForm:!0}),"1"==t.isChannelGreat&&this.setState({isChannelGreatDefaultChecked:!0})),"1"===t.isChannelOpening&&this.setState({isChannelOpeningDefaultChecked:!0}),"1000"===t.mktResPettyType&&this.setState({isChannelGreatDisabled:!0}),"1002"===t.mktResPettyType&&this.setState({isShowAppointForm:!0})}},{key:"renderAppointmentForm",value:function(e){var a=this.state.isShowAppointForm;return a?this.appointmentForm(e):""}},{key:"renderForm",value:function(e){var a=this.state.isShowChannelGreatForm;return a?this.channelGreatForm(e):this.channelOpenForm(e)}},{key:"channelOpenForm",value:function(e){var a=this.props,t=a.form,n=(a.data,a.dispatch,t.getFieldDecorator);t.validateFields,t.getFieldValue;return V.a.createElement("div",null,V.a.createElement("div",{className:M.a.title},"\u6e20\u9053\u5f00\u901a\u8bbe\u7f6e"),V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:"\u542f\u7528\u6e20\u9053\u5f00\u901a"},n("isChannelOpening",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u542f\u7528\u6e20\u9053\u5f00\u901a"}],initialValue:this.state.isChannelOpeningDefaultChecked})(V.a.createElement(E["a"],{checked:this.state.isChannelOpeningDefaultChecked,disabled:this.state.isChannelOpeningSwitch})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u4e1a\u52a1\u6807\u8bc6"},n("channelOpeningCd",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e1a\u52a1\u6807\u8bc6"}]})(V.a.createElement(h["a"],null)))))),V.a.createElement(p["a"],{style:{marginBottom:32}}))}},{key:"channelGreatForm",value:function(e){var a=this.props,t=a.form,n=(a.data,a.dispatch,t.getFieldDecorator),l=(t.validateFields,t.getFieldValue,this.props.data.ruleForm),i=function(e){console.log("switch to ".concat(e))};return V.a.createElement("div",null,V.a.createElement("div",{className:M.a.title},"\u6e20\u9053\u53d1\u653e\u8bbe\u7f6e"),V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:"\u542f\u7528\u6e20\u9053\u53d1\u653e"},n("isChannelGreat",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u6e20\u9053\u53d1\u653e"}],initialValue:"1"===e.isChannelGreat})(V.a.createElement(E["a"],{defaultChecked:this.state.isChannelGreatDefaultChecked,onChange:i,disabled:this.state.isChannelGreatDisabled})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u4e1a\u52a1\u6807\u8bc6"},n("channelGreatObjCd",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e1a\u52a1\u6807\u8bc6"}],initialValue:l.channelGreatObjCd||""})(V.a.createElement(h["a"],{placeholder:"\u8bf7\u8f93\u5165\u4e1a\u52a1\u6807\u8bc6"})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u53d1\u653e\u5bf9\u8c61\u9650\u5236"},n("channelGreatObjType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u53d1\u653e\u5bf9\u8c61\u9650\u5236"}],initialValue:[e.channelGreatObjType]||!1})(V.a.createElement(N,{options:z,disabled:this.state.isChannelGreatDisabled})))))),V.a.createElement(p["a"],{style:{marginBottom:32}}))}},{key:"appointmentForm",value:function(e){var a=this.props,t=a.form,n=(a.data,a.dispatch,t.getFieldDecorator),l=(t.validateFields,t.getFieldValue,this.props.data.ruleForm);return V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:" \u9700\u8981\u9884\u7ea6"},n("couponDiscountRule.isAppointment",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u9700\u8981\u9884\u7ea6"}],initialValue:e.couponDiscountRule.isAppointment||""})(V.a.createElement(x["a"],{className:"CouponDiscountRule",attrCode:"isAppointment"})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u9884\u7ea6\u9650\u5236"},n("couponDiscountRule.appointmentType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9884\u7ea6\u9650\u5236"}],initialValue:e.couponDiscountRule.appointmentType||[]})(V.a.createElement(N,{options:z,disabled:this.state.isAppointmentTypeDisabled})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u9884\u7ea6\u7f51\u5740"},n("couponDiscountRule.appointmentUrl",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9884\u7ea6\u7f51\u5740"}],initialValue:l.appointmentUrl||""})(V.a.createElement("div",null,V.a.createElement(h["a"],{addonBefore:"http://",addonAfter:".com",defaultValue:"mysite"})))))))}},{key:"bussinessRulesForm",value:function(e){var a=this,t=this.props,n=t.form,l=t.data,i=(t.dispatch,n.getFieldDecorator),s=(n.validateFields,n.getFieldValue,l.ruleForm,function(e){console.log("checked = ",e)}),r=[{label:"\u81ea\u7528",value:"1000"},{label:"\u8f6c\u8d60",value:"1100"}],o=function(e){console.log("\u56fa\u5b9a\u5929\u6570 \u53d8\u5316\u4e3a ".concat(e)),a.setState({timeDurationLimit:e})};return V.a.createElement("div",null,this.renderForm(e),V.a.createElement("div",{className:M.a.title},"\u4f7f\u7528\u89c4\u5219"),V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:"\u4f7f\u7528\u65b9\u5f0f"},i("usageType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4f7f\u7528\u65b9\u5f0f"}],initialValue:[e.couponDiscountRule.usageType]||!1})(V.a.createElement(N,{options:r,disabled:this.state.isUsageTypeDisabled,onChange:s})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u4f7f\u7528\u6b21\u6570"},i("couponDiscountRule.usageCounterLimit",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4f7f\u7528\u6b21\u6570"}],initialValue:e.couponDiscountRule.usageCounterLimit||""})(V.a.createElement(x["a"],{className:"CouponDiscountRule",attrCode:"usageCounterLimit",disabled:this.state.isTimeLimitTypeDisabled})))),V.a.createElement("div",null,"1100"===e.couponDiscountRule.timeLimitType?V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u4f7f\u7528\u65f6\u6548"},i("couponDiscountRule.timeDurationLimit",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5929\u6570"}],initialValue:e.couponDiscountRule.timeDurationLimit||"30"})(V.a.createElement(u["a"],{min:1,formatter:function(e){return"\u56fa\u5b9a".concat(e,"\u5929")},style:{width:120},max:1e8,onChange:o})))):V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u4f7f\u7528\u65f6\u6548"},i("couponDiscountRule.timeLimitType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4f7f\u7528\u65f6\u6548"}],initialValue:e.couponDiscountRule.timeLimitType||""})(V.a.createElement(x["a"],{className:"CouponDiscountRule",attrCode:"timeLimitType",disabled:this.state.isTimeLimitTypeDisabled}))))))),this.renderAppointmentForm(e),V.a.createElement(p["a"],{style:{marginBottom:32}}),V.a.createElement("div",{className:M.a.title},"\u7ed3\u7b97\u89c4\u5219"),V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:"\u7ed3\u7b97\u65f6\u95f4"},i("rightsBalanceRuleDetail.balanceOpportunity",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7ed3\u7b97\u65f6\u95f4"}],initialValue:e.rightsBalanceRuleDetail.balanceOpportunity||""})(V.a.createElement(c["a"],{placeholder:"\u8bf7\u9009\u62e9\u7ed3\u7b97\u65f6\u95f4",disabled:this.state.isBalanceOpportunityDisabled},V.a.createElement(Option,{value:"1000"},"\u4f7f\u7528\u5373\u7ed3\u7b97"),V.a.createElement(Option,{value:"1100"},"\u4f7f\u7528\u4e2d\u6bcf\u6708\u7ed3\u7b97"))))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u7ed3\u7b97\u5355\u4ef7"},i("rightsBalanceRuleDetail.balancePrice",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7ed3\u7b97\u5355\u4ef7"}]})(V.a.createElement(h["a"],{placeholder:"\u8bf7\u8f93\u5165\u7ed3\u7b97\u5355\u4ef7"})))))),V.a.createElement(p["a"],{style:{marginBottom:32}}),V.a.createElement("div",{className:M.a.title},"\u6838\u9500\u89c4\u5219"),V.a.createElement(k["a"],{layout:"horizontal"},V.a.createElement(d["a"],{gutter:16},V.a.createElement(g["a"],{lg:6,md:12,sm:24},V.a.createElement(k["a"].Item,{label:"\u4f7f\u7528\u6838\u9500"},i("verificationType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6838\u9500\u65b9\u5f0f"}],initialValue:e.verificationType||""})(V.a.createElement(x["a"],{className:"MktResource",attrCode:"verificationType",disabled:this.state.isVerificationTypeDisabled})))),V.a.createElement(g["a"],{xl:{span:6,offset:2},lg:{span:8},md:{span:12},sm:24},V.a.createElement(k["a"].Item,{label:"\u5931\u6548\u6838\u9500"},V.a.createElement("p",null,"\u672a\u4f7f\u7528\u72b6\u6001\u4e14\u5230\u8fbe\u5931\u6548\u65e5\u671f\u540e\u6838\u9500 "))))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.form,n=a.data,l=a.dispatch,i=(t.getFieldDecorator,t.validateFields),o=this.props.data,c=(o.paramsArr,o.index,o.selectedTemplate),u=(o.currentStep,o.baseForm),p=o.ruleForm,d=c,h=function(){i(function(e,a){l({type:"resource/saveResource",payload:m()({},n,{currentStep:1,ruleForm:m()({},p,a)})})})},g=function(a){a.preventDefault(),i(function(a,t){t.hasOwnProperty("channelGreatObjType")&&(t.channelGreatObjType=t.channelGreatObjType.join(",")),t.hasOwnProperty("usageType")&&(t.couponDiscountRule.usageType=t.usageType.join(",")),t.hasOwnProperty("isChannelGreat")?!0===t.isChannelGreat?t.isChannelGreat=1:t.isChannelGreat=0:t.isChannelGreat=-1,t.hasOwnProperty("isChannelOpening")?!0===t.isChannelOpening?t.isChannelOpening=1:t.isChannelOpening=0:t.isChannelOpening=-1,Object.assign(t,u),t.hasOwnProperty("rangeTimePicker")&&(t.effDate=j()(t.rangeTimePicker[0],"YYYY-MM-DD HH:mm:ss").valueOf(),t.expDate=j()(t.rangeTimePicker[1],"YYYY-MM-DD HH:mm:ss").valueOf()),t.initialInventoryExpDate=j()(t.initialInventoryExpDate,"YYYY-MM-DD HH:mm:ss").valueOf(),t.discountRuleId=d.couponDiscountRule.discountRuleId,t.balanceRuleId=d.rightsBalanceRuleDetail.balanceRuleId,t.balanceRuleDetailId=d.rightsBalanceRuleDetail.balanceRuleDetailId,"1100"===d.couponDiscountRule.timeLimitType&&(t.couponDiscountRule.timeDurationLimit=e.state.timeDurationLimit),delete t.rangeTimePicker,delete t.mktResTemplate,delete t.usageType,a||P["a"](t).then(function(e){null!=e&&l({type:"resource/saveResource",payload:{baseForm:m()({},e),currentStep:3,index:1}})})})};return V.a.createElement(s["a"],{bordered:!1,style:{margin:"36px 0"}},V.a.createElement("div",null,this.bussinessRulesForm(d)),V.a.createElement(k["a"],{layout:"horizontal",className:L.a.stepForm,hideRequiredMark:!0},V.a.createElement(k["a"].Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:Y.wrapperCol.span,offset:Y.labelCol.span}},label:""},V.a.createElement(r["a"],{onClick:h,style:{marginRight:16}},"\u4e0a\u4e00\u6b65"),V.a.createElement(r["a"],{type:"primary",onClick:g},"\u4e0b\u4e00\u6b65"))))}}]),a}(V.a.PureComponent))||i)||i);a["default"]=H}}]);